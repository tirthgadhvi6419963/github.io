<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>üíò For Aayushi</title>
  <meta name="theme-color" content="#ff4d6d" />
  <style>
    :root{
      --bg1:#ffebf3; --bg2:#ffe6cc;
      --card:rgba(255,255,255,.86);
      --text:#141414; --muted:rgba(20,20,20,.68);
      --shadow:0 18px 52px rgba(0,0,0,.14);
      --radius:26px; --pill:999px;
      --pink1:#ff4d8d; --pink2:#ff2d55;
      --line:rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 700px at 25% 12%, rgba(255,255,255,.95) 0%, rgba(255,255,255,0) 60%),
        radial-gradient(900px 700px at 75% 0%, rgba(255,255,255,.75) 0%, rgba(255,255,255,0) 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow:hidden;
      padding: 18px;
    }

    /* Floating hearts background */
    .heart{
      position:absolute;
      width:18px; height:18px;
      transform: rotate(45deg);
      background: rgba(255,255,255,0.85);
      animation: floatUp linear infinite;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,0.10));
      border-radius:4px;
      pointer-events:none;
    }
    .heart:before,.heart:after{
      content:"";
      position:absolute;
      width:18px; height:18px;
      background: inherit;
      border-radius:50%;
    }
    .heart:before{ left:-9px; top:0 }
    .heart:after{ top:-9px; left:0 }
    @keyframes floatUp{
      from{ transform:translateY(45vh) translateX(0) rotate(45deg); opacity:0 }
      10%{opacity:1}
      to{ transform:translateY(-120vh) translateX(80px) rotate(45deg); opacity:0 }
    }

    canvas#fx{
      position:fixed;
      inset:0;
      pointer-events:none;
    }

    .wrap{
      position:relative;
      width:min(640px, 94vw);
      padding: 26px 18px;
      border-radius: var(--radius);
      background: var(--card);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,.70);
      text-align:center;
    }

    .badge{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding: 9px 12px;
      border-radius: var(--pill);
      background: rgba(255,45,85,0.12);
      color: var(--pink2);
      font-weight: 800;
      letter-spacing: .2px;
    }

    h1{
      margin: 14px 0 10px;
      font-size: clamp(26px, 5.5vw, 44px);
      line-height: 1.08;
      letter-spacing: -.2px;
    }

    p{
      margin: 0 auto 16px;
      max-width: 52ch;
      color: var(--muted);
      font-size: clamp(14.5px, 3.8vw, 16px);
      line-height: 1.55;
    }

    .btn{
      appearance:none;
      border:none;
      cursor:pointer;
      padding: 14px 18px;
      width: min(420px, 100%);
      border-radius: 16px;
      font-size: 18px;
      font-weight: 900;
      color: #fff;
      background: linear-gradient(135deg, var(--pink2), var(--pink1));
      box-shadow: 0 16px 32px rgba(255,45,85,0.30);
      transform: translateY(0);
      transition: transform .12s ease, box-shadow .12s ease;
      position:relative;
      overflow:hidden;
      touch-action: manipulation;
    }
    .btn:hover{ transform: translateY(-1px); box-shadow: 0 20px 40px rgba(255,45,85,0.38); }
    .btn:active{ transform: translateY(1px); box-shadow: 0 12px 26px rgba(255,45,85,0.25); }
    .btn:focus-visible{ outline: 3px solid rgba(255,255,255,.95); outline-offset: 3px; }
    .btn::after{
      content:"";
      position:absolute; inset:-40%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), rgba(255,255,255,0) 60%);
      transform: translateX(-42%) rotate(10deg);
      transition: transform .5s ease;
      pointer-events:none;
    }
    .btn:hover::after{ transform: translateX(5%) rotate(10deg); }

    .miniRow{
      margin-top: 14px;
      display:flex;
      justify-content:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .mini{
      font-size: 13px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.90);
      cursor:pointer;
      touch-action: manipulation;
    }
    .mini:hover{ background: rgba(255,255,255,0.98); }

    .footer{
      margin-top: 14px;
      font-size: 12.5px;
      color: rgba(20,20,20,0.55);
    }

    /* Success */
    .success{ display:none; animation: pop .35s ease both; }
    @keyframes pop{
      from{ transform: scale(.985); opacity:0 }
      to{ transform: scale(1); opacity:1 }
    }
    .bigEmoji{
      font-size: 56px;
      margin: 10px 0 6px;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.12));
    }

    /* Gift options (mobile-friendly) */
    #giftPanel{
      display:none;
      margin-top: 16px;
      text-align:left;
      border-top: 1px dashed var(--line);
      padding-top: 14px;
    }
    .giftTitle{
      margin: 0 0 10px;
      color: rgba(20,20,20,0.78);
      font-weight: 900;
      text-align:center;
    }
    .optionsGrid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    @media (max-width: 440px){
      .optionsGrid{ grid-template-columns: 1fr; }
      .wrap{ padding: 22px 16px; }
    }
    .optionCard{
      text-align:left;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.92);
      border-radius: 16px;
      padding: 12px 12px;
      cursor: pointer;
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
      touch-action: manipulation;
      min-height: 78px; /* bigger tap area */
    }
    .optionCard:hover{
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.08);
    }
    .optionCard.selected{
      border-color: rgba(255,45,85,0.55);
      box-shadow: 0 18px 34px rgba(255,45,85,0.18);
    }
    .optEmoji{ font-size: 22px; margin-bottom: 6px; }
    .optTitle{ font-weight: 950; color:#111; }
    .optSub{ font-size: 12.5px; color: rgba(20,20,20,0.60); margin-top: 2px; }

    .giftActions{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 12px;
    }

    .statusBox{
      display:none;
      margin-top: 12px;
      text-align:center;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,0.92);
      font-weight: 900;
      color:#111;
    }
    .subStatus{
      display:none;
      margin-top: 8px;
      text-align:center;
      font-size: 13px;
      color: rgba(20,20,20,0.62);
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background: rgba(0,0,0,0.78);
      color:#fff;
      padding:10px 12px;
      border-radius: 12px;
      font-size: 13px;
      opacity:0;
      transition: opacity .2s ease, transform .2s ease;
      pointer-events:none;
      z-index: 20;
    }
    .toast.show{ opacity:1; transform:translateX(-50%) translateY(-4px); }
  </style>
</head>

<body>
  <canvas id="fx"></canvas>

  <main class="wrap" role="main" aria-live="polite">
    <!-- ASK -->
    <section class="ask" id="ask">
      <div class="badge">üíå Just for Aayushi</div>
      <h1>Aayushi‚Ä¶ will you be my Valentine? üíò</h1>
      <p>
        I tried to write something ‚Äúcool‚Äù‚Ä¶ but honestly:
        you make my days feel softer and my smiles feel easier.
        So‚Ä¶ one tiny click? üòÑ
      </p>

      <!-- ONLY YES -->
      <button class="btn" id="yesBtn">Yes üíò</button>

      <div class="miniRow">
        <button class="mini" id="copyLinkBtn" type="button">Copy shareable link</button>
      </div>

      <div class="footer">Works great on phone too ‚ú®</div>
    </section>

    <!-- SUCCESS -->
    <section class="success" id="success">
      <div class="badge">‚úÖ Officially adorable</div>
      <div class="bigEmoji" id="bigEmoji">üíñ</div>
      <h1>YAYYY! It‚Äôs a date üíû</h1>
      <p id="successText">Aayushi, you just made my whole day (and probably the next 365 too).</p>

      <button class="btn" id="celebrateBtn">Celebrate üéâ</button>

      <!-- GIFT OPTIONS (appears after Celebrate) -->
      <div id="giftPanel">
        <div class="giftTitle">Okay Aayushi üòÑ pick what you want:</div>

        <div class="optionsGrid" id="giftOptions">
          <button class="optionCard" data-gift="Flowers üíê">
            <div class="optEmoji">üíê</div>
            <div class="optTitle">Flowers</div>
            <div class="optSub">classic + pretty</div>
          </button>

          <button class="optionCard" data-gift="Chocolate üç´">
            <div class="optEmoji">üç´</div>
            <div class="optTitle">Chocolate</div>
            <div class="optSub">sweet tooth approved</div>
          </button>

          <button class="optionCard" data-gift="Small teddy üß∏">
            <div class="optEmoji">üß∏</div>
            <div class="optTitle">Small teddy</div>
            <div class="optSub">tiny + cute</div>
          </button>

          <button class="optionCard" data-gift="Flowers + Ice cream üíêüç¶">
            <div class="optEmoji">üíêüç¶</div>
            <div class="optTitle">Flowers + Ice cream</div>
            <div class="optSub">best combo</div>
          </button>
        </div>

        <div class="giftActions">
          <button class="btn" id="confirmGiftBtn">Confirm ‚úÖ</button>
          <button class="mini" id="copyGiftBtn" type="button" style="display:none;">Copy message</button>
        </div>

        <div class="statusBox" id="giftResult"></div>
        <div class="subStatus" id="submitStatus"></div>

        <div class="footer" style="text-align:center; margin-top:12px;">
          (Auto-sends to Tirth after confirm ‚úÖ)
        </div>
      </div>
    </section>
  </main>

  <div class="toast" id="toast">Copied!</div>

<script>
  /***********************
   * CONFIG
   ***********************/
  const DEFAULT_FROM = "Tirth";
  const FORM_ENDPOINT = "https://formspree.io/f/xkovjdwn"; // ‚úÖ your Formspree endpoint

  /***********************
   * URL PARAMS
   ***********************/
  const params = new URLSearchParams(location.search);
  const fromName = params.get("from") || DEFAULT_FROM;
  const toName = "Aayushi";

  /***********************
   * BACKGROUND HEARTS
   ***********************/
  const HEARTS = 18;
  for (let i=0; i<HEARTS; i++){
    const h = document.createElement("div");
    h.className = "heart";
    const left = Math.random()*100;
    const dur = 6 + Math.random()*7;
    const delay = Math.random()*-dur;
    const size = 10 + Math.random()*18;
    h.style.left = left + "vw";
    h.style.animationDuration = dur + "s";
    h.style.animationDelay = delay + "s";
    h.style.width = size + "px";
    h.style.height = size + "px";
    h.style.opacity = (0.35 + Math.random()*0.55).toFixed(2);
    document.body.appendChild(h);
  }

  /***********************
   * CANVAS FX
   ***********************/
  const canvas = document.getElementById("fx");
  const ctx = canvas.getContext("2d");
  let W, H;

  function resize(){
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }
  window.addEventListener("resize", resize);
  resize();

  const confetti = [];
  const bursts = [];

  function confettiBurst(x, y){
    const count = 140;
    for (let i=0; i<count; i++){
      confetti.push({
        x: x + (Math.random()-0.5)*90,
        y: y + (Math.random()-0.5)*40,
        vx: (Math.random()-0.5)*10,
        vy: -Math.random()*10 - 4,
        g: 0.22 + Math.random()*0.18,
        r: 2 + Math.random()*4,
        a: 1,
        spin: (Math.random()-0.5)*0.25
      });
    }
  }

  function emojiBurst(x, y){
    const emojis = ["üíñ","üíò","üíû","‚ú®","üòç","ü•∞","üíù","üå∏"];
    for (let i=0; i<26; i++){
      bursts.push({
        x, y,
        vx: (Math.random()-0.5)*8,
        vy: -Math.random()*7 - 3,
        g: 0.18 + Math.random()*0.12,
        a: 1,
        rot: (Math.random()-0.5)*0.3,
        size: 18 + Math.random()*14,
        char: emojis[Math.floor(Math.random()*emojis.length)]
      });
    }
  }

  function multiCelebrate(){
    const cx = W/2, cy = H/2;
    confettiBurst(cx, cy);
    emojiBurst(cx, cy);
    setTimeout(()=>{ confettiBurst(cx, cy-40); emojiBurst(cx, cy-40); }, 180);
    setTimeout(()=>{ confettiBurst(cx, cy+20); emojiBurst(cx, cy+20); }, 360);
  }

  function tick(){
    ctx.clearRect(0,0,W,H);

    for (let i=confetti.length-1; i>=0; i--){
      const p = confetti[i];
      p.vy += p.g;
      p.x += p.vx;
      p.y += p.vy;
      p.a *= 0.985;

      if (p.a < 0.02 || p.y > H+50){
        confetti.splice(i,1);
        continue;
      }

      ctx.save();
      ctx.globalAlpha = p.a;
      ctx.translate(p.x, p.y);
      ctx.rotate(p.spin);

      const grd = ctx.createLinearGradient(-6,-6,6,6);
      grd.addColorStop(0, "rgba(255,255,255,0.95)");
      grd.addColorStop(1, "rgba(255,255,255,0.35)");
      ctx.fillStyle = grd;
      ctx.fillRect(-p.r, -p.r, p.r*2, p.r*2);
      ctx.restore();
    }

    for (let i=bursts.length-1; i>=0; i--){
      const b = bursts[i];
      b.vy += b.g;
      b.x += b.vx;
      b.y += b.vy;
      b.a *= 0.982;

      if (b.a < 0.03 || b.y > H+80){
        bursts.splice(i,1);
        continue;
      }

      ctx.save();
      ctx.globalAlpha = b.a;
      ctx.translate(b.x, b.y);
      ctx.rotate(b.rot);
      ctx.font = `${b.size}px system-ui, Apple Color Emoji, Segoe UI Emoji`;
      ctx.fillText(b.char, -b.size/2, b.size/2);
      ctx.restore();
    }

    requestAnimationFrame(tick);
  }
  tick();

  /***********************
   * UI FLOW
   ***********************/
  const ask = document.getElementById("ask");
  const success = document.getElementById("success");
  const yesBtn = document.getElementById("yesBtn");
  const celebrateBtn = document.getElementById("celebrateBtn");
  const bigEmoji = document.getElementById("bigEmoji");
  const successText = document.getElementById("successText");

  const giftPanel = document.getElementById("giftPanel");
  const giftOptions = document.getElementById("giftOptions");
  const confirmGiftBtn = document.getElementById("confirmGiftBtn");
  const giftResult = document.getElementById("giftResult");
  const submitStatus = document.getElementById("submitStatus");
  const copyGiftBtn = document.getElementById("copyGiftBtn");

  let clickCount = 0;
  let selectedGift = "";

  const emojiCycle = ["üíñ","üíò","üíû","üòç","ü•∞","üíù","‚ú®","üå∏"];
  const lineCycle = [
    `Aayushi, you just made ${fromName} smile like an idiot üòÑ`,
    "Okayyy this is officially cute now üíû",
    "You‚Äôre making this way too adorable üòç",
    "More confetti. More love. Yes. üíñ",
    "If happiness had a button‚Ä¶ it‚Äôs this one ü•∞",
    "This is your fault (in the best way) üíù"
  ];

  function showToast(msg){
    const toast = document.getElementById("toast");
    toast.textContent = msg;
    toast.classList.add("show");
    setTimeout(()=>toast.classList.remove("show"), 1200);
  }

  function goYes(){
    ask.style.display = "none";
    success.style.display = "block";
    multiCelebrate();
  }
  yesBtn.addEventListener("click", goYes);

  celebrateBtn.addEventListener("click", () => {
    clickCount++;
    multiCelebrate();

    if (giftPanel.style.display === "none") {
      giftPanel.style.display = "block";
      setTimeout(() => giftPanel.scrollIntoView({behavior:"smooth", block:"start"}), 80);
    }

    bigEmoji.textContent = emojiCycle[clickCount % emojiCycle.length];
    successText.textContent = lineCycle[clickCount % lineCycle.length];

    const btnTexts = ["Celebrate üéâ","Again! üéä","One more üòÑ","Okay last one üòÖ","Moreee üíñ"];
    celebrateBtn.textContent = btnTexts[clickCount % btnTexts.length];
  });

  function setSelectedGift(btn){
    [...giftOptions.querySelectorAll(".optionCard")].forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");
    selectedGift = btn.dataset.gift || "";
  }

  giftOptions.addEventListener("click", (e) => {
    const btn = e.target.closest(".optionCard");
    if (!btn) return;
    setSelectedGift(btn);
    emojiBurst(W/2, H/2 - 20);
  });

  function buildChoiceMessage(){
    return `Aayushi chose: ${selectedGift} üíñ (From: ${fromName})`;
  }

  async function submitChoice(message){
    try{
      submitStatus.style.display = "block";
      submitStatus.textContent = "Sending to Tirth‚Ä¶ ‚ú®";

      const res = await fetch(FORM_ENDPOINT, {
        method: "POST",
        headers: { "Content-Type": "application/json", "Accept": "application/json" },
        body: JSON.stringify({
          to: toName,
          from: fromName,
          gift: selectedGift,
          message,
          page: location.href,
          time: new Date().toISOString()
        })
      });

      if (!res.ok) throw new Error("Non-200 response");
      return true;
    }catch(e){
      return false;
    }
  }

  confirmGiftBtn.addEventListener("click", async () => {
    if (!selectedGift) {
      giftResult.style.display = "block";
      giftResult.textContent = "Pick one first üòÑüëá";
      emojiBurst(W/2, H/2);
      return;
    }

    const msg = buildChoiceMessage();

    giftResult.style.display = "block";
    giftResult.textContent = `Locked in ‚úÖ ${msg}`;
    copyGiftBtn.style.display = "inline-flex";

    multiCelebrate();
    emojiBurst(W/2, H/2 - 40);

    const ok = await submitChoice(msg);
    submitStatus.style.display = "block";
    submitStatus.textContent = ok
      ? "Sent ‚úÖ (Tirth will receive it by email)"
      : "Couldn‚Äôt auto-send üòï Try again or copy the message.";

    if (ok) showToast("Sent ‚úÖ");
    else showToast("Send failed üòï");
  });

  copyGiftBtn.addEventListener("click", async () => {
    const msg = giftResult.textContent.replace("Locked in ‚úÖ ", "");
    try{
      await navigator.clipboard.writeText(msg);
      showToast("Copied üíå");
    }catch(e){
      showToast("Copy manually");
    }
  });

  /***********************
   * COPY SHAREABLE LINK
   ***********************/
  document.getElementById("copyLinkBtn").addEventListener("click", async () => {
    const base = location.origin + location.pathname;
    const link = base + `?from=${encodeURIComponent(fromName)}`;
    try{
      await navigator.clipboard.writeText(link);
      showToast("Link copied üíå");
    }catch(e){
      showToast("Copy from address bar");
    }
  });
</script>
</body>
</html>
